<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>都匯水果ERP系統</title>
    <!-- css檔
    <link rel="stylesheet" href="Index.css"> -->
    <style>
        /* 基本樣式 */
body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    overflow-x: hidden;
}

header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background-color: #f0f0f0;
    padding: 10px 20px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    position: relative;
}

.btn {
    padding: 10px 15px;
    border: none;
    cursor: pointer;
    margin: 0 5px;
    border-radius: 5px;
    transition: background-color 0.3s;
}

.btn-primary {
    background-color: #007bff;
    color: white;
}

.btn-danger {
    background-color: #dc3545;
    color: white;
}

/* Hover效果 */
.btn:hover {
    background-color: #d3d3d3;
}

.header-left {
    display: flex;
    align-items: center;
}

.user-info {
    margin-left: 20px;
}

/* 搜尋區 */
.search-bar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin: 20px 20px;
}

.search-actions {
    display: flex;
    gap: 10px;
}

#notification {
    color: red;
    font-weight: bold;
    display: none;
}

/* 表格 */
table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px 20px;
    pointer-events: none;
    background-color: #f2f2f2;
    opacity: 0.7;
    transition: background-color 0.3s, opacity 0.3s;
    cursor: not-allowed;
}

table.unlocked {
    pointer-events: auto;
    background-color: white;
    opacity: 1;
    cursor: pointer;
}

th, td {
    border: 1px solid #ddd;
    padding: 8px;
    text-align: left;
}

th {
    background-color: #f0f0f0;
}

/* 右側選單 */
.sidebar {
    position: fixed;
    top: 0;
    right: 0;
    width: 250px;
    height: 100%;
    background-color: #333;
    color: white;
    box-shadow: -2px 0 5px rgba(0, 0, 0, 0.2);
    transform: translateX(100%);
    transition: transform 0.3s ease;
    display: flex;
    flex-direction: column;
    padding: 20px;
    z-index: 1002; /* 確保選單在最上層 */
}

.sidebar.active {
    transform: translateX(0);
}

.sidebar a {
    text-decoration: none;
    color: white;
    padding: 10px 0;
    border-bottom: 1px solid #555;
    margin-bottom: 10px;
    transition: background-color 0.3s;
}

.sidebar a:last-child {
    border-bottom: none;
}

.sidebar a:hover {
    background-color: #555;
}

.sidebar .close-btn {
    text-align: right;
    font-size: 18px;
    cursor: pointer;
    margin-bottom: 20px;
}

/* 給右側選單的遮罩 */
.overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    display: none;
    z-index: 1001; /* 確保遮罩不會覆蓋選單 */
}
/* 右側選單遮罩active時 */
.overlay.active {
    display: block;
}


/* 修改訂單的彈出視窗樣式 */
.reviseModal {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: white;
    padding: 20px;
    border-radius: 5px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    z-index: 1003;
    /* modal跳出視窗一開始要是不顯示的狀態 */
    display: none;
    width: 300px;
}
/* 當視窗彈出時 */
.reviseModal.active {
    display: block;
}
/* 選擇所有屬於 .modal 元素內的 button 元素 */
/* 意味著它會應用樣式到 .modal 類別內的每個按鈕元素。 */
.reviseModal button {
    margin-top: 10px;
}
/* 針對在 .modal 內部的第一個按鈕進行樣式設置。 */
.reviseModal button:first-child {
    background-color: #28a745;
    color: white;
}
/* 針對在 .modal 內部的最後一個按鈕進行樣式設置。 */
.reviseModal button:last-child {
    background-color: #dc3545;
    color: white;
}
/* 修改訂單的彈出視窗樣式 */


/* <<單筆新增彈出視窗>>樣式 */
.insertOneModal {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: white;
    padding: 20px;
    border-radius: 5px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    z-index: 1003;
    /* modal跳出視窗一開始要是不顯示的狀態 */
    display: none;
    width: 700px;
    height:700px;
    /* 限制高度並啟用滾動條 */
    max-height: 70vh; /* 視窗高度的 70% */
    overflow-y: auto; /* 垂直滾動 */
}
    /* 當視窗彈出時 */
.insertOneModal.active {
    display: block;
}
    /* 選擇所有屬於 .modal 元素內的 button 元素 */
    /* 意味著它會應用樣式到 .modal 類別內的每個按鈕元素。 */
.insertOneModal button {
    margin-top: 10px;
}
    /* 針對在 .modal 內部的第一個按鈕進行樣式設置。 */
.insertOneModal button:first-child {
    background-color: #28a745;
    color: white;
}
    /* 針對在 .modal 內部的最後一個按鈕進行樣式設置。 */
.insertOneModal button:last-child {
    background-color: #dc3545;
    color: white;
}
    /* <<單筆新增視窗>>頁面內容 */
.insertOneModal-content {
    background-color: white;
    padding: 20px;
    border-radius: 10px;
    width: 500px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}
    /* <<單筆新增視窗>>關閉按鈕 */
.insertOneModal .close-btn{
    position: absolute;
    top: 10px;
    right: 10px;
    font-size: 20px;
    cursor: pointer;
}
    /* 表單樣式 */
.insertOneForm-group {
    margin-bottom: 15px;
}
    /*  <<單筆新增視窗>>保存和取消按鈕 */
.insertOneForm-actions {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
}
    /* <<單筆新增視窗>>表單題目樣式 */
.insertOneForm label {
    display: block;
    margin-bottom: 5px;
    font-size: 14px;
}
    /* <<單筆新增視窗>>填寫欄位樣式 */
.insertOneModal input, select, textarea {
    width: 100%;
    padding: 8px;
    border: 1px solid #ccc;
    border-radius: 5px;
    font-size: 14px;
}
    /* <<單筆新增視窗>>品項欄位 */
.item-row {
    display: flex; /* 設置彈性盒模型 */
    align-items: center; /* 垂直置中 */
    gap: 10px; /* 設置元素間距 */
    margin-bottom: 10px; /* 每一行的下方間距 */
}
    /* <<單筆新增視窗>>品項&數量 填寫長方條 */
.item-row select, .item-row input {
    flex: 1; /* 讓子元素自動調整寬度 */
    max-width: 200px; /* 設置最大寬度，避免太寬 */
}  
/* <<單筆新增彈出視窗>>樣式 */

/* <<多筆匯入彈出視窗>>樣式 */
        .insertMany {
            display: none; /* 預設隱藏 */
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
        }

        .insertMany-content {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            width: 300px;
            text-align: center;
        }

        .insertManyClose {
            float: right;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
        }

        .insertManyClose:hover {
            color: red;
        }

        .insertMany button {
            padding: 10px 20px;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .insertMany button:hover {
            background-color: #0056b3;
        }

        .insertMany input[type="file"] {
            margin: 20px 0;
        }
/* <<多筆匯入彈出視窗>>樣式 */



/* 固定右側選單展開按鈕位置 */
.fixed-buttons {
    position: absolute;
    right: 20px;
    top: 50%;
    transform: translateY(-50%);
    display: flex;
    flex-direction: column;
    gap: 10px;
}

/* 新增按鈕區 */
.button-row {
    display: flex;
    justify-content: flex-start;
    margin: 20px 20px;
    gap: 10px;
}

/* 給跳出視窗的遮罩(不希望點選頁面中其他內容就關閉視窗的遮罩) */
.overlayForModal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    display: none;
    z-index: 1001; /* 確保遮罩不會覆蓋選單 */
}
/* 給跳出視窗的遮罩啟動時(不希望點選頁面中其他內容就關閉視窗的遮罩) */
.overlayForModal.active {
    display: block;
}
    </style>
</head>
<body>
    <!-- 頁面頂部 Header -->
    <header>
        <div class="header-left">
            <div>訂單管理系統</div>
            <div class="user-info" id="userInfo">你好，xxx!</div>
        </div>
        <div class="fixed-buttons">
            <button id="menuButton" class="btn btn-primary">☰</button>
        </div>
    </header>


    <!-- 新增按鈕區 -->
    <div class="button-row">
        <button class="btn btn-primary" id="insertOne-btn">單筆新增</button>
        <button class="btn btn-primary" id="insertMany-btn">多筆匯入</button>
        <button class="btn btn-primary">查詢訂單</button>
        <button class="btn btn-danger"> 刪除訂單</button>
        <button class="btn btn-primary">匯出黑貓格式</button>
    </div>

    <!-- 搜尋區 -->
    <div class="search-bar">
        <div>
            <input type="text" id="searchInput" placeholder="輸入查詢條件">
            <button class="btn btn-primary" id="searchButton">搜尋</button>
            <span id="notification">查無訂單</span>
        </div>
        <div class="search-actions">
            <button class="btn btn-danger" id="unLockOrderListButton">解鎖訂單列表</button>
            <button id="lockOrderListButton" class="btn btn-primary" disabled>鎖定訂單列表</button>
        </div>
    </div>
    

    <!-- 表格 -->
    <table id="orderTable">
        <thead>
            <tr>
                <th>訂單編號</th>
                <th>客戶名稱</th>
                <th>訂單日期</th>
                <th>總金額</th>
                <th>狀態</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>12345</td>
                <td>王小明</td>
                <td>2024-11-25</td>
                <td>$5000</td>
                <td>已完成</td>
            </tr>
        </tbody>
    </table>

    <!-- for右側選單的遮罩 -->
    <div id="overlay" class="overlay"></div>
    <!-- for跳出視窗的遮罩 -->
    <div id="overlayForModal" class="overlayForModal"></div>

    <!-- 右側選單 -->
    <div id="sidebar" class="sidebar">
        <div class="close-btn" id="closeSidebar">X</div>
        <a href="#" id="loginLogoutButton">登出</a>
        <a href="#">空白選項 1</a>
        <a href="#">空白選項 2</a>
        <a href="#">空白選項 3</a>
    </div>

    <!-- 修改訂單彈出視窗 -->
    <div id="reviseModal" class="reviseModal">
        <p>是否保存更改?</p>
        <button id="reviseSaveModalButton">保存</button>
        <button id="cancelModalButton">取消</button>
    </div>

    <!-- 單筆新增彈出視窗 -->
    <div id="insertOneModal" class="insertOneModal">
        <div class="insertOneModal-content" id="insertOneModal-content">
            <div class="close-btn" id="closeInsertOneModal">X</div>
            <form id="insertOneOrderForm">
                <h2>單筆新增</h2>
                <div class="insertOneForm-group">
                    <label>*客戶名稱：</label>
                    <select required id="insertOneCustomer">
                        <option value="" disabled selected>請選擇</option>
                        <option value="1">客戶 1</option>
                        <option value="2">客戶 2</option>
                    </select>
                </div>
                <div class="insertOneForm-group">
                    <label>*收件人姓名+稱謂：</label>
                    <input type="text" required id="insertOneRecipient">
                </div>
                <div class="insertOneForm-group">
                    <label>*配送地址：</label>
                    <input type="text" required id="insertOneAddress">
                </div>
                <div class="insertOneForm-group">
                    <label>收件人公司：</label>
                    <input type="text" id="insertOneRecipientCompany">
                </div>
                <div class="insertOneForm-group">
                    <label>收件人電話：</label>
                    <input type="text" id="insertOnePhoneNO">
                </div>
                <div class="insertOneForm-group">
                    <label>出貨備註：</label>
                    <textarea id="insertOneNote"></textarea>
                </div>
                <!-- 畫面中本來就有的那個品項 -->
                <div class="item-row">
                    <label>*品項：</label>
                    <select required name="item[]" id="insertOneItem">
                        <option value="" disabled selected>請選擇</option>
                        <option value="1">品項 1</option>
                        <option value="2">品項 2</option>
                    </select>
                    <label>*數量：</label>
                    <input type="number" min="1" required name="quantity[]" id="insertOneAmount">
                </div>
                <!-- 用來裝動態生成的品項(生成的class 還有name都跟上面的一樣) -->
                <div class="insertOneForm-group" id="insertOneItems-container"></div>
                <!-- 新增品項按鈕 -->
                <button type="button" id="addItemBtn">新增品項</button>
                <div class="insertOneForm-actions">
                    <button type="submit" id="insertOneSaveModalButton">提交</button>
                    <button type="button" id="insertOneCancelModalButton">取消</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 多筆匯入彈出視窗 -->
    <div id="insertManyModal" class="insertMany">
        <div class="insertMany-content">
            <!-- &times是叉叉符號 -->
            <span id="closeModalBtn" class="insertManyClose">&times;</span>
            <h2>多筆匯入</h2>
            <a href="../CSVsample/insertManySample.csv" class="download-button" download="insertManySample.csv">csv範例</a>
            <input type="file" id="csvFileInput" accept=".csv">
            <button id="uploadBtn">上傳</button>
        </div>
    </div>


    <script>
        // 選取元素
        const menuButton = document.getElementById('menuButton');
        const sidebar = document.getElementById('sidebar');
        const closeSidebar = document.getElementById('closeSidebar');
        //給右側選單的遮罩，當點選到遮罩內容時，右側選單回復收起狀態
        const overlay = document.getElementById('overlay');
        const loginLogoutButton = document.getElementById('loginLogoutButton');
        const userInfo = document.getElementById('userInfo');
        const searchButton = document.getElementById('searchButton');
        const searchInput = document.getElementById('searchInput');
        const notification = document.getElementById('notification');
        const orderTable = document.getElementById('orderTable');
        const unLockOrderListButton = document.getElementById('unLockOrderListButton');
        const lockOrderListButton = document.getElementById('lockOrderListButton');
        //修改訂單的視窗
        const reviseModal = document.getElementById('reviseModal');
        const reviseSaveModalButton = document.getElementById('reviseSaveModalButton');
        const cancelModalButton = document.getElementById('cancelModalButton');
        //給跳出視窗的遮罩(不希望點選頁面中其他內容就關閉視窗的遮罩)
        const overlayForModal = document.getElementById('overlayForModal');
        // 監測<<單筆新增按鈕>>
        const insertOne = document.getElementById('insertOne-btn');
        //監聽<<單筆新增彈出視窗>>的元素
            //<<單筆新增彈出視窗>>本身
        const insertOneModal = document.getElementById('insertOneModal');
            //<<單筆新增彈出視窗>><<提交訂單按鈕>>
        const insertOneSaveModalButton = document.getElementById('insertOneSaveModalButton');
            //<<單筆新增彈出視窗>><<取消按鈕>>
        const insertOneCancelModalButton = document.getElementById('insertOneCancelModalButton');
            //<<單筆新增彈出視窗>><<叉叉按鈕>>
        const closeInsertOneModal = document.getElementById("closeInsertOneModal");
            //<<單筆新增彈出視窗>><<控制畫面上的品項數量>>
        const insertOneItemsContainer = document.getElementById('insertOneItems-container');
            //<<單筆新增彈出視窗>><<新增品項按鈕>>
        const addItemBtn = document.getElementById('addItemBtn');
            // <<單筆新增彈出視窗>><<表單中所有的欄位>>
        const insertOneOrderForm = document.getElementById('insertOneOrderForm');
            //<<單筆新增彈出視窗>><<表單中客戶名稱欄位>>
        const insertOneCustomer = document.getElementById('insertOneCustomer');
            //收件人欄位 
        const insertOneRecipient = document.getElementById('insertOneRecipient');
            // 配送地址欄位
        const insertOneAddress = document.getElementById('insertOneAddress');
            //收件人公司欄位
        const insertOneRecipientCompany = document.getElementById('insertOneRecipientCompany');
            // 收件人電話
        const insertOnePhoneNO = document.getElementById('insertOnePhoneNO');
            // 出貨備註
        const insertOneNote = document.getElementById('insertOneNote');
            //預設的品項
        const insertOneItem = document.getElementById('insertOneItem');
            //預設的數量
        const insertOneAmount = document.getElementById('insertOneAmount');

        //單筆新增操作
        //點擊單筆新增按鈕時跳出 <單筆新增彈出視窗>
        insertOne.addEventListener('click', () =>{
            insertOneModal.classList.add('active');//跳出 <<修改訂單彈出視窗>>
            overlayForModal.classList.add('active'); // 禁用其他頁面內容
        });
        // <<單筆新增彈出視窗>><<保存按鈕>>操作
        insertOneOrderForm.onsubmit=function(event){
            event.preventDefault(); // 防止表單默認提交行為
            // 驗證表單是否有效(重點在用了form.checkValidity():會檢查required欄位是否有正確填寫)
            if (insertOneOrderForm.checkValidity()) {
                //用來取得<<單筆新增彈出視窗>>中輸入的品項內容
                // 創建一個空的 array 用來存儲品項和數量
                const orderItems = [];

                // 遍歷所有的品項和數量欄位
                const itemSelects = document.querySelectorAll('[name="item[]"]');
                const quantityInputs = document.querySelectorAll('[name="quantity[]"]');

                for (let i = 0; i < itemSelects.length; i++) {
                    const item = itemSelects[i].value;
                    const quantity = quantityInputs[i].value;

                    // 將每個品項和數量的值存入 orderItems 陣列中
                    if (item && quantity) {  // 檢查品項和數量是否都有填寫
                        orderItems.push({ item, quantity });
                    }
                }

                alert("表單驗證成功！提交資料...");
                //表單通過驗證，用post方法去後端新增一筆訂單
                console.log(orderItems);
                fetch('http://localhost:8080/insertOrder', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        "barcode":null,
                        "orderNO":null,
                        "client":insertOneCustomer.value,
                        "recipient":insertOneRecipient.value,
                        "recipientCompany":insertOneRecipientCompany.value,
                        "address":insertOneAddress.value,
                        "phoneNO":insertOnePhoneNO.value,
                        "note":insertOneNote.value,
                        "latitude":1.54684,
                        "longitude":4.7896,
                        "state":1,
                        "shippedDate":null,
                        "insertionDate":null,
                        "insertionStaff":1,
                        "lastReviseDate":null,
                        "lastReviseStaff":null,
                        "deleteDate":null,
                        "deleteStaff":null,
                        "difficultBit":0,
                        "orderItems":orderItems
                    })
                })
                .then(response => response.json())  // 假設回應是JSON格式
                .then(data => {
                    console.log('訂單已成功新增:', data);
                    // 在訂單新增成功後關閉視窗
                    //1.刪除動態生成的欄位 2.清空視窗欄位中內容 3.關閉視窗&遮罩
                    //1.2.
                    cleanInsertOneModalContent();
                    //3.
                    insertOneModal.classList.remove('active');//關閉<<單筆新增彈出視窗>>
                    overlayForModal.classList.remove('active');//取消<<跳出視窗遮罩>>(不希望點選頁面中其他內容就關閉視窗的遮罩)
                })
                .catch(error => {
                    console.error('處理請求時發生錯誤:', error);
                });
            } else {
                // 如果表單無效，顯示錯誤訊息
                alert("請填寫所有必填欄位！");
            }
        };
        //用來清空單筆新增視窗的欄位，以及動態生成的品項欄位
        function cleanInsertOneModalContent(){
            //刪除動態生成的欄位
            insertOneItemsContainer.textContent="";
            //刪除填寫訂單的欄位
            insertOneCustomer.selectedIndex=0;
            insertOneRecipient.value="";
            insertOneAddress.value="";
            insertOneRecipientCompany.value="";
            insertOnePhoneNO.value="";
            insertOneNote.value="";
            insertOneItem.selectedIndex=0;
            insertOneAmount.value="";
        }
        // <<單筆新增彈出視窗>><<取消按鈕>>
        insertOneCancelModalButton.addEventListener('click', () => {
            cleanInsertOneModalContent();
            insertOneModal.classList.remove('active');//關閉<<單筆新增彈出視窗>>
            overlayForModal.classList.remove('active');//取消<<跳出視窗遮罩>>
        });
        // <<單筆新增彈出視窗>><<叉叉按鈕>>
        closeInsertOneModal.addEventListener('click', () =>{
            cleanInsertOneModalContent();
            insertOneModal.classList.remove('active');//關閉<<單筆新增彈出視窗>>
            overlayForModal.classList.remove('active');//取消<<跳出視窗遮罩>>
        });
        // <<單筆新增彈出視窗>><<新增品項按鈕>>
        addItemBtn.addEventListener('click', ()=>{
            //創建新的放品項和數量區域
            const itemRow = document.createElement('div');
            itemRow.classList.add('item-row');
            //創建品項label
            const itemLabel =document.createElement('label');
            itemLabel.textContent = "*品項：";
            // 創建品項下拉選單
            const itemSelect = document.createElement('select');
            itemSelect.name = 'item[]';
            itemSelect.required = true;

            // 添加 "請選擇" 的選項
            const defaultOption = document.createElement('option');
            defaultOption.value = ""; // 設為空值
            defaultOption.textContent = "請選擇"; // 顯示的文字
            defaultOption.disabled = true; // 不可選
            defaultOption.selected = true; // 預設選中
                //把請選擇選項添加到選項中
            itemSelect.appendChild(defaultOption);
            // 假設有二個品項選項
            const items = [{name: '品項 1',value: 1},
                           {name: '品項 2',value: 2}];
            items.forEach(function(item) {
                const option = document.createElement('option');
                option.value = item.value;
                option.textContent = item.name;
                itemSelect.appendChild(option);
            });
            //創建數量label
            const amountLabel = document.createElement('label');
            amountLabel.textContent = "*數量：";
            // 創建數量欄位
            const quantityInput = document.createElement('input');
            quantityInput.type = 'number';
            quantityInput.name = 'quantity[]';

            itemRow.appendChild(itemLabel);
            itemRow.appendChild(itemSelect);
            itemRow.appendChild(amountLabel);
            itemRow.appendChild(quantityInput);

            insertOneItemsContainer.appendChild(itemRow);
        })


    //多筆匯入操作
        const insertMany = document.getElementById('insertMany-btn');
        const closeModalBtn = document.getElementById('closeModalBtn');
        const insertManyModal = document.getElementById('insertManyModal');
        // 打開模態視窗
        insertMany.addEventListener('click', () => {
          insertManyModal.style.display = 'flex';
        });

        // 關閉模態視窗
        closeModalBtn.addEventListener('click', () => {
            cleanCSVFile();
            insertManyModal.style.display = 'none';
        });

        // 點擊模態視窗外部關閉視窗
        window.addEventListener('click', (event) => {
            cleanCSVFile();
            if (event.target === insertManyModal) {
              insertManyModal.style.display = 'none';
            }
        });

        // 處理檔案上傳按鈕
        const uploadBtn = document.getElementById('uploadBtn');
        const csvFileInput = document.getElementById('csvFileInput');

        uploadBtn.addEventListener('click', () => {
            const file = csvFileInput.files[0];
            //如果有選擇檔案(file不為null)
            if (file) {
                // 執行上傳處理邏輯
                // 使用FileReader讀取文件內容
                var reader = new FileReader();
                reader.readAsText(file,'utf-8');//用utf-8編碼來解析
                // reader 是一個FileReader物件，用來讀取檔案內容
                //當檔案讀取完成後，onload事件會被觸發，並執行指定的回呼函式
                reader.onload = function(e){
                    // e是事件物件，代表這次讀取檔案的操作結果。
                    // e.target是觸發事件的目標物件(這裡是FileReader)
                    // e.target.result 是讀取完的檔案內容
                    var contents = e.target.result;
                    // 檔案是按行拆分
                    // lines是一個陣列，包含每一行的資料(每一行是一個index)，其中每一行的資料並沒有根據","把內容分開
                    var lines = contents.split('\n');

                    //解析csv數據
                    //用headers陣列來記錄表頭的資訊(長度以及內容)
                    var headers = lines[0].split(',');
                    var data = [];
                    //從lines[1]開始(不要表頭)
                    for(var i=1;i<lines.length;i++){
                        //values包含行資料根據","分割後的結果
                        var values = lines[i].split(',');
                        //只取到表頭(headers)長度的欄位
                        if(values.length === headers.length){
                            //創建名為Order_data的鍵值對
                            var Order_data = {};
                            //照表頭長度把資料放入Order_data鍵值對
                            for(var j=0;j<headers.length;j++){
                                //把表頭的值作為鍵存放，values作為值存放
                                Order_data[headers[j]] = values[j];
                            }
                            //把Order_data鍵值對存放至data陣列
                            data.push(Order_data);
                        }

                    }
                    //把data陣列中的內容一行一行提交給後端。
                    data.forEach(function(Order_data) {
                        //把Order_data的值存入變數，準備傳到後端
                        var clientNameInput = Order_data[headers[0]];
                        console.log(clientNameInput);
                        var receipientInput = Order_data[headers[1]];
                        console.log(receipientInput);
                        var addressInput = Order_data[headers[2]];
                        console.log(addressInput);
                        var productInput = Order_data[headers[3]];
                        console.log(productInput);
                        var quantityInput = Order_data[headers[4]];
                        console.log(quantityInput);
                        var receipientPhoneInput = Order_data[headers[5]];
                        console.log(receipientPhoneInput);
                        var receipientCompanyInput = Order_data[headers[6]];
                        console.log(receipientCompanyInput);
                        var noteInput = Order_data[headers[7]];
                        console.log(noteInput);
                        //TODO :呼叫後端API
                    });
                }
                //提交完刪除檔案
                cleanCSVFile();
                insertManyModal.style.display = 'none';//關閉視窗
            } 
            //如果沒有選擇檔案
            else {
                alert('請選擇一個檔案！');
            }
        });

        function cleanCSVFile(){
            csvFileInput.value='';//清除檔案
        }
    //多筆匯入操作

        // 右側選單操作
        // 展開右側選單
        menuButton.addEventListener('click', () => {
            sidebar.classList.add('active');
            overlay.classList.add('active');
        });
        // 收起右側選單（按 X 或點擊遮罩）
        closeSidebar.addEventListener('click', closeSidebarMenu);
        overlay.addEventListener('click', closeSidebarMenu);
        // 收起右側選單function
        function closeSidebarMenu() {
            sidebar.classList.remove('active');
            overlay.classList.remove('active');
        }
        // 登入登出切換
        loginLogoutButton.addEventListener('click', () => {
            let isLoggedIn = loginLogoutButton.textContent === "登出";
            if (isLoggedIn) {
                userInfo.textContent = "請先登入";
                loginLogoutButton.textContent = "登入";
            } else {
                userInfo.textContent = "你好，xxx!";
                loginLogoutButton.textContent = "登出";
            }
        });


        // 搜尋邏輯
        searchButton.addEventListener('click', () => {
            const searchInputValue = searchInput.value;
            if (searchInputValue) {
                // 用javaScript直接去操作css的屬性
                // 通知欄位為隱藏狀態
                notification.style.display = 'none';
                // 表格變成解鎖狀態
                orderTable.classList.add('unlocked'); 
            } else {
                // 通知欄位為出現狀態
                notification.style.display = 'block';
                // 設定 3 秒後隱藏通知
                setTimeout(function() {
                    notification.style.display = 'none';  // 3秒後隱藏
                }, 3000);  // 1000 毫秒 = 1 秒
                // 表格解除鎖定狀態
                orderTable.classList.remove('unlocked'); 
            }
        });

        // 訂單列表的操作
        // 解鎖訂單列表按鈕
        unLockOrderListButton.addEventListener('click', () => {
            orderTable.classList.add('unlocked'); // 解鎖表格
            lockOrderListButton.disabled = false; // 啟用保存按鈕
        });
        // 鎖定訂單列表按鈕
        lockOrderListButton.addEventListener('click', () => {
            orderTable.classList.remove('unlocked'); // 鎖定表格
            lockOrderListButton.disabled = true; // 禁用保存按鈕
        });
        // 讓表格變為可點選的狀態，顯示小手
        orderTable.addEventListener('mouseover', () => {
            if (orderTable.classList.contains('unlocked')) {
                orderTable.style.cursor = 'pointer'; // 變成小手
            }
        });

        //操作修改訂單彈出視窗
        // 點擊表格時顯示修改訂單彈出視窗
        orderTable.addEventListener('click', (event) => {
            if (orderTable.classList.contains('unlocked') && event.target.tagName === 'TD') {
                reviseModal.classList.add('active');//跳出 <<修改訂單彈出視窗>>
                overlayForModal.classList.add('active'); // 禁用其他頁面內容
            }
        });
        // <<修改訂單彈出視窗>><<保存按鈕>>
        reviseSaveModalButton.addEventListener('click', () => {
            orderTable.classList.remove('unlocked'); // 鎖定表格
            lockOrderListButton.disabled = true; // 禁用保存按鈕
            reviseModal.classList.remove('active');
            overlayForModal.classList.remove('active');//取消跳出視窗遮罩(不希望點選頁面中其他內容就關閉視窗的遮罩)
        });
        // <<修改訂單彈出視窗>><<取消按鈕>>
        cancelModalButton.addEventListener('click', () => {
            reviseModal.classList.remove('active');
            overlayForModal.classList.remove('active');//取消跳出視窗遮罩
        });

    </script>
</body>
</html>